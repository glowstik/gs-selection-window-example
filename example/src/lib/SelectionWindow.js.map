{"mappings":"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","sources":["src/SelectionWindow.js","src/SelectionWindow.module.css"],"sourcesContent":["import React from \"react\";\nimport useSize from \"@react-hook/size\";\nimport styles from './SelectionWindow.module.css'\n\nexport function SelectionWindow({ children, crop, onCropChange, className = undefined, mouseThreshold = 30, touchThreshold = 60 }) {\n  const [node, setNode] = React.useState(null);\n  const selectionRef = React.useRef(null);\n  const stateRef = React.useRef({ \n    dragging: false,\n    pointers: new Map(),\n    edges: []\n  })\n  const [containerWidth, containerHeight] = useSize(node);\n\n  React.useEffect(\n    () => {\n      if (!crop && containerWidth && containerHeight) {\n        onCropChange({\n          left: containerWidth * 0.25,\n          top: containerHeight * 0.25,\n          right: containerWidth * 0.75,\n          bottom: containerHeight * 0.75,\n          width: containerWidth * 0.5,\n          height: containerHeight * 0.5,\n          container: {\n            width: containerWidth,\n            height: containerHeight\n          }\n        })\n      }\n    },\n    [crop, containerWidth, containerHeight]\n  )\n\n  const touchMoveEvent = useEvent(handleTouchMove)\n  const dragStartEvent = useEvent(handleDragStart)\n  const dragEvent = useEvent(handleDrag)\n  const dragEndEvent = useEvent(handleDragEnd)\n\n  React.useEffect(\n    () => {\n      if (!node) return\n      node.addEventListener('touchmove', touchMoveEvent)\n      node.addEventListener('pointerdown', dragStartEvent)\n      \n      return () => {\n        node.removeEventListener('touchmove', touchMoveEvent)\n        node.removeEventListener('pointerdown', dragStartEvent)\n      }\n    },\n    [node]\n  )\n\n  return (\n    <div ref={setNode} className={cx(className, styles.component)}>\n      <div\n        ref={selectionRef}\n        className={styles.selection}\n        style={{\n          position: \"absolute\",\n          left: px(crop?.left ?? 0),\n          top: px(crop?.top ?? 0),\n          width: px((crop?.right ?? 0) - (crop?.left ?? 0)),\n          height: px((crop?.bottom ?? 0) - (crop?.top ?? 0)),\n        }}\n        {...{ children }}\n      />\n    </div>\n  );\n\n  function handleDragStart(e) {\n    e.preventDefault();\n    \n    const { x, y } = getXY(e)\n    const threshold = e.pointerType === 'mouse' ? mouseThreshold : touchThreshold\n    const pointerState = getPointerState({ x, y, threshold })\n    \n    stateRef.current.dragging = true\n    stateRef.current.pointers.set(e.pointerId, pointerState)\n    stateRef.current.edges = stateRef.current.edges.concat(pointerState.edges)\n\n    window.addEventListener('pointermove', dragEvent, { passive: true })\n    window.addEventListener('pointerup', dragEndEvent)\n    window.addEventListener('pointercancel', dragEndEvent)\n  }\n\n  function handleTouchMove(e) {\n    if (!stateRef.current.dragging) return\n    e.preventDefault()\n  }\n\n  function handleDrag(e) {\n    if (!stateRef.current.dragging) return\n    \n    const pointerState = stateRef.current.pointers.get(e.pointerId)\n    const { x, y } = getXY(e)\n    const threshold = e.pointerType === 'mouse' ? mouseThreshold : touchThreshold\n\n    if (pointerState.edges.length) {\n      transformSelection({ pointerState, x: x - pointerState.dx, y: y - pointerState.dy, threshold })\n    } else if (stateRef.current.pointers.size === 1) {\n      moveSelection({ dx: e.movementX, dy: e.movementY })\n    } \n  }\n\n  function handleDragEnd(e) {\n    if (!stateRef.current.pointers.has(e.pointerId)) return // Drag already ended, multiple events can end dragging\n\n    const { edges } = stateRef.current.pointers.get(e.pointerId)\n    stateRef.current.edges = stateRef.current.edges.filter(x => !edges.includes(x))\n    stateRef.current.pointers.delete(e.pointerId)\n    stateRef.current.dragging = Boolean(stateRef.current.edges)\n\n    window.removeEventListener('pointermove', dragEvent, { passive: true })\n    window.removeEventListener('pointerup', dragEndEvent)\n    window.removeEventListener('pointercancel', dragEndEvent)\n  }\n\n  function getXY(e) {\n    const { clientX, clientY } = e\n    const rect = node.getBoundingClientRect()\n    return {\n      x: clientX - rect.left,\n      y: clientY - rect.top\n    }\n  }\n\n  function getPointerState({ x, y, threshold }) {\n    const edges = [];\n    const dl = x - crop.left;\n    const dr = x - crop.right;\n    const dt = y - crop.top;\n    const db = y - crop.bottom;\n\n    const adl = Math.abs(dl);\n    const adr = Math.abs(dr);\n    const adt = Math.abs(dt);\n    const adb = Math.abs(db);\n\n    if (adl <= adr && adl < threshold) edges.push(\"left\");\n    else if (adr <= adl && adr < threshold) edges.push(\"right\");\n    if (adt <= adb && adt < threshold) edges.push(\"top\");\n    else if (adb <= adt && adb < threshold) edges.push(\"bottom\");\n\n    return { \n      dx: edges.includes('left') ? dl : edges.includes('right') ? dr : 0, \n      dy: edges.includes('top') ? dt : edges.includes('bottom') ? db : 0, \n      edges: edges.filter(x => !stateRef.current.edges.includes(x))\n    };\n  }\n\n  function transformSelection({ pointerState, x, y, threshold }) {\n    const newCrop = { ...crop }\n\n    if (pointerState.edges.includes(\"left\")) {\n      newCrop.left = x;\n      newCrop.right = Math.max(crop.right, x + threshold);\n    } else if (pointerState.edges.includes(\"right\")) {\n      newCrop.right = x;\n      newCrop.left = Math.min(crop.left, x - threshold);\n    }\n\n    if (pointerState.edges.includes(\"top\")) {\n      newCrop.top = y;\n      newCrop.bottom = Math.max(newCrop.bottom, y + threshold);\n    } else if (pointerState.edges.includes(\"bottom\")) {\n      newCrop.bottom = y;\n      newCrop.top = Math.min(crop.top, y - threshold);\n    }\n\n    onCropChange({\n      ...newCrop,\n      width: newCrop.right - newCrop.left,\n      height: newCrop.bottom - newCrop.top,\n      container: {\n        width: containerWidth,\n        height: containerHeight\n      }\n    })\n  }\n\n  function moveSelection({ dx, dy }) {\n    const newCrop = { ...crop }\n\n    const clampedDx = clamp(-crop.left, crop.containerWidth - crop.right, dx)\n    const clampedDy = clamp(-crop.top, crop.containerHeight - crop.bottom, dy)\n    \n    newCrop.left += clampedDx\n    newCrop.right += clampedDx\n    newCrop.top += clampedDy\n    newCrop.bottom += clampedDy\n\n    onCropChange({\n      ...newCrop,\n      width: newCrop.right - newCrop.left,\n      height: newCrop.bottom - newCrop.top,\n      container: {\n        width: containerWidth,\n        height: containerHeight\n      }\n    })\n  }\n}\n\nfunction px(n) {\n  return n + \"px\";\n}\n\nfunction clamp(left, right, value) {\n  const [min, max] = left < right ? [left, right] : [right, left]\n  return Math.max(min, Math.min(max, value))\n}\n\nfunction cx(...classes) {\n  return classes.filter(Boolean).join(' ')\n}\n\nfunction useEvent(fn) {\n  const fnRef = React.useRef(null)\n  fnRef.current = fn\n\n  return React.useCallback((...args) => fnRef.current(...args), [])\n}\n",null],"names":[],"version":3,"file":"SelectionWindow.js.map","sourceRoot":"../../../"}